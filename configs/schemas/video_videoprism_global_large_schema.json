{
  "name": "video_videoprism_global_large",
  "document": {
    "fields": [
      {
        "name": "video_id",
        "type": "string",
        "indexing": [
          "summary",
          "attribute"
        ]
      },
      {
        "name": "video_title",
        "type": "string",
        "indexing": [
          "index",
          "summary"
        ],
        "index": "enable-bm25"
      },
      {
        "name": "creation_timestamp",
        "type": "long",
        "indexing": [
          "summary",
          "attribute"
        ]
      },
      {
        "name": "frame_id",
        "type": "int",
        "indexing": [
          "summary",
          "attribute"
        ]
      },
      {
        "name": "start_time",
        "type": "float",
        "indexing": [
          "summary",
          "attribute"
        ]
      },
      {
        "name": "end_time",
        "type": "float",
        "indexing": [
          "summary",
          "attribute"
        ]
      },
      {
        "name": "embedding",
        "type": "tensor<float>(v[1024])",
        "indexing": [
          "attribute",
          "index"
        ],
        "attribute": ["distance-metric: angular"]
      },
      {
        "name": "embedding_binary",
        "type": "tensor<int8>(v[128])",
        "indexing": [
          "attribute"
        ],
        "attribute": ["distance-metric: hamming"]
      }
    ]
  },
  "fieldsets": [
    {
      "name": "default",
      "fields": [
        "video_title"
      ]
    }
  ],
  "rank_profiles": [
    {
      "name": "default",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        }
      ],
      "first_phase": "closeness(field, embedding_binary)",
      "timeout": 2.0
    },
    {
      "name": "bm25_only",
      "first_phase": "bm25(video_title)",
      "timeout": 2.0
    },
    {
      "name": "binary_binary",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        }
      ],
      "first_phase": "closeness(field, embedding_binary)",
      "match_features": ["distance(field, embedding_binary)"],
      "timeout": 2.0
    },
    {
      "name": "float_float",
      "inputs": [
        {
          "name": "query(qt)",
          "type": "tensor<float>(v[1024])"
        }
      ],
      "first_phase": "closeness(field, embedding)",
      "timeout": 2.0
    },
    {
      "name": "float_binary",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        },
        {
          "name": "query(qt)",
          "type": "tensor<float>(v[1024])"
        }
      ],
      "functions": [
        {
          "name": "unpack_binary_representation",
          "expression": "2*unpack_bits(attribute(embedding_binary)) - 1"
        }
      ],
      "first_phase": "sum(query(qt) * unpack_binary_representation, v)",
      "timeout": 2.0
    },
    {
      "name": "phased",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        },
        {
          "name": "query(qt)",
          "type": "tensor<float>(v[1024])"
        }
      ],
      "functions": [
        {
          "name": "unpack_binary_representation",
          "expression": "2*unpack_bits(attribute(embedding_binary)) - 1"
        }
      ],
      "first_phase": "closeness(field, embedding_binary)",
      "second_phase": {
        "expression": "sum(query(qt) * unpack_binary_representation, v)",
        "rerank_count": 100
      },
      "match_features": ["distance(field, embedding_binary)"],
      "timeout": 5.0
    },
    {
      "name": "hybrid_float_bm25",
      "inputs": [
        {
          "name": "query(qt)",
          "type": "tensor<float>(v[1024])"
        }
      ],
      "functions": [
        {
          "name": "visual_sim",
          "expression": "closeness(field, embedding)"
        },
        {
          "name": "text_sim",
          "expression": "bm25(video_title)"
        }
      ],
      "first_phase": "visual_sim",
      "second_phase": {
        "expression": "text_sim",
        "rerank_count": 100
      },
      "timeout": 2.0
    },
    {
      "name": "hybrid_binary_bm25",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        }
      ],
      "functions": [
        {
          "name": "visual_sim",
          "expression": "closeness(field, embedding_binary)"
        },
        {
          "name": "text_sim",
          "expression": "bm25(video_title)"
        }
      ],
      "first_phase": "visual_sim + 0.1 * text_sim",
      "timeout": 2.0
    },
    {
      "name": "hybrid_bm25_binary",
      "inputs": [
        {
          "name": "query(qtb)",
          "type": "tensor<int8>(v[128])"
        }
      ],
      "functions": [
        {
          "name": "visual_sim",
          "expression": "closeness(field, embedding_binary)"
        },
        {
          "name": "text_sim",
          "expression": "bm25(video_title)"
        }
      ],
      "first_phase": "text_sim",
      "second_phase": {
        "expression": "visual_sim",
        "rerank_count": 100
      },
      "timeout": 2.0
    },
    {
      "name": "hybrid_bm25_float",
      "inputs": [
        {
          "name": "query(qt)",
          "type": "tensor<float>(v[1024])"
        }
      ],
      "functions": [
        {
          "name": "visual_sim",
          "expression": "closeness(field, embedding)"
        },
        {
          "name": "text_sim",
          "expression": "bm25(video_title)"
        }
      ],
      "first_phase": "text_sim",
      "second_phase": {
        "expression": "visual_sim",
        "rerank_count": 100
      },
      "timeout": 2.0
    }
  ]
}