{
  "comment": "Multi-Agent RAG System Configuration - Copy this file to config.json and modify the values as needed",
  "text_agent_url": "http://localhost:8002",
  "video_agent_url": "http://localhost:8001",
  "composing_agent_port": 8000,
  "search_backend": "vespa",
  "elastic_cloud_id": "your_elastic_cloud_id",
  "elastic_api_key": "your_elastic_api_key",
  "elastic_index": "your-text-index",
  "vespa_url": "http://localhost",
  "vespa_port": 8080,
  "vespa_schema": "video_frame",
  "byaldi_index_name": ".byaldi/my_video_index",
  "vlm_endpoint_url": "https://amit-jain--cogniverse-vlm-vlmmodel-generate-description.modal.run/",
  "auto_start_vlm_service": true,
  "colpali_model": "vidore/colsmol-500m",
  "embedding_model": "all-MiniLM-L6-v2",
  "local_llm_model": "deepseek-r1:7b",
  "base_url": "http://localhost:11434",
  "remote_inference_url": null,
  "evaluation_datasets": {
    "default": "visual_test_queries",
    "registry_path": "configs/dataset_registry.json"
  },
  "evaluators": {
    "visual_judge": {
      "provider": "ollama",
      "model": "llava:7b",
      "base_url": "http://localhost:11434",
      "api_key": null,
      "frames_per_video": 30,
      "max_videos": 2,
      "sample_all_frames": false,
      "max_total_frames": 60
    },
    "llm_judge": {
      "provider": "ollama",
      "model": "deepseek-r1:7b",
      "base_url": "http://localhost:11434",
      "api_key": null
    },
    "modal_visual_judge": {
      "provider": "modal",
      "model": "qwen2-vl",
      "base_url": "https://your-modal-endpoint.modal.run/",
      "api_key": "your-modal-api-key"
    }
  },
  "remote_inference_api_key": null,
  "remote_inference_provider": null,
  "videoprism_repo_path": "/Users/amjain/source/hobby/videoprism",
  "pipeline_cache": {
    "enabled": true,
    "backends": [
      {
        "backend_type": "structured_filesystem",
        "base_path": "~/.cache/cogniverse/structured_pipeline",
        "serialization_format": "json",
        "priority": 0,
        "enable_ttl": true,
        "cleanup_on_startup": true,
        "metadata_format": "json"
      }
    ],
    "default_ttl": 0,
    "enable_compression": true,
    "serialization_format": "json"
  },
  "video_processing_profiles": {
    "video_colpali_smol500_mv_frame": {
      "vespa_schema": "video_mv_frame",
      "embedding_model": "vidore/colsmol-500m",
      "pipeline_config": {
        "extract_keyframes": true,
        "transcribe_audio": true,
        "generate_descriptions": true,
        "generate_embeddings": true,
        "keyframe_strategy": "fps",
        "keyframe_fps": 1.0
      },
      "embedding_type": "frame_based",
      "schema_config": {
        "schema_name": "video_colpali",
        "model_name": "ColPali",
        "num_patches": 1024,
        "embedding_dim": 128,
        "binary_dim": 16
      }
    },
    "video_colqwen_omni_sv_chunk": {
      "vespa_schema": "video_sv_chunk",
      "embedding_model": "vidore/colqwen-omni-v0.1",
      "process_type": "video_chunks",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": true,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "video_chunks",
      "model_specific": {
        "max_patches": 1024,
        "segment_duration": 30.0,
        "chunk_duration": 30.0,
        "chunk_overlap": 5.0,
        "extract_audio": true,
        "transcribe_audio": true,
        "whisper_model": "base",
        "store_as_single_doc": true,
        "adaptive_segmentation": false,
        "max_pixels": 16777216,
        "sampling_fps": 1.0
      },
      "schema_config": {
        "schema_name": "video_sv_chunk",
        "model_name": "ColQwen-Omni",
        "num_patches": 1024,
        "embedding_dim": 128,
        "binary_dim": 16
      }
    },
    "video_videoprism_base_mv_chunk": {
      "vespa_schema": "video_mv_chunk",
      "embedding_model": "videoprism_public_v1_base_hf",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": false,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "direct_video_segment",
      "model_specific": {
        "segment_duration": 30.0,
        "sampling_fps": 1.0,
        "max_frames": 30,
        "min_frames": 8,
        "frame_features": true,
        "native_dimensions": true
      },
      "inference_config": {
        "model_type": "videoprism",
        "backend": "auto",
        "query_encoder": "vidore/colsmol-500m"
      },
      "schema_config": {
        "schema_name": "video_mv_chunk",
        "model_name": "VideoPrism-Base",
        "num_patches": 4096,
        "embedding_dim": 768,
        "binary_dim": 96
      }
    },
    "video_videoprism_large_mv_chunk": {
      "vespa_schema": "video_mv_chunk",
      "embedding_model": "videoprism_public_v1_large_hf",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": false,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "direct_video_segment",
      "model_specific": {
        "segment_duration": 30.0,
        "sampling_fps": 1.0,
        "max_frames": 30,
        "min_frames": 8,
        "frame_features": true,
        "native_dimensions": true
      },
      "inference_config": {
        "model_type": "videoprism",
        "backend": "auto",
        "query_encoder": "vidore/colsmol-500m"
      },
      "schema_config": {
        "schema_name": "video_mv_chunk",
        "model_name": "VideoPrism-Large",
        "num_patches": 2048,
        "embedding_dim": 1024,
        "binary_dim": 128
      }
    },
    "video_videoprism_base_sv_global": {
      "vespa_schema": "video_sv_global",
      "embedding_model": "videoprism_lvt_public_v1_base",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": false,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "direct_video_global",
      "model_specific": {
        "sampling_fps": 1.0,
        "max_frames": 40,
        "global_embedding": true
      },
      "inference_config": {
        "model_type": "videoprism_global",
        "backend": "auto",
        "query_encoder": "videoprism_lvt_public_v1_base"
      },
      "schema_config": {
        "schema_name": "video_sv_global",
        "model_name": "VideoPrism-LVT-Base",
        "embedding_dim": 768,
        "binary_dim": 96,
        "global_embedding": true
      }
    },
    "video_videoprism_large_sv_global": {
      "vespa_schema": "video_sv_global",
      "embedding_model": "videoprism_lvt_public_v1_large",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": false,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "direct_video_global_large",
      "model_specific": {
        "sampling_fps": 1.0,
        "max_frames": 40,
        "global_embedding": true
      },
      "inference_config": {
        "model_type": "videoprism_global",
        "backend": "auto",
        "query_encoder": "videoprism_lvt_public_v1_large"
      },
      "schema_config": {
        "schema_name": "video_sv_global",
        "model_name": "VideoPrism-LVT-Large",
        "embedding_dim": 1024,
        "binary_dim": 128,
        "global_embedding": true
      }
    },
    "video_videoprism_large_sv_chunk_6s": {
      "vespa_schema": "video_sv_chunk",
      "embedding_model": "videoprism_lvt_public_v1_large",
      "processing_type": "single_vector",
      "pipeline_config": {
        "extract_keyframes": false,
        "transcribe_audio": true,
        "generate_descriptions": false,
        "generate_embeddings": true
      },
      "embedding_type": "video_chunks",
      "model_specific": {
        "chunk_duration": 6.0,
        "chunk_overlap": 1.0,
        "sampling_fps": 2.0,
        "max_frames_per_chunk": 12,
        "min_frames": 4,
        "store_as_single_doc": true,
        "native_dimensions": true
      },
      "inference_config": {
        "model_type": "videoprism",
        "backend": "auto",
        "query_encoder": "videoprism_lvt_public_v1_large"
      },
      "schema_config": {
        "schema_name": "video_sv_chunk",
        "model_name": "VideoPrism-Large-Chunks",
        "embedding_dim": 1024,
        "binary_dim": 128,
        "chunk_based": true
      }
    }
  },
  "active_video_profile": "video_colpali_smol500_mv_frame",
  "query_inference_engine": {
    "mode": "llm",
    "available_gliner_models": [
      "urchade/gliner_small-v2.1",
      "urchade/gliner_medium-v2.1",
      "urchade/gliner_large-v2.1",
      "urchade/gliner_multi-v2.1"
    ],
    "current_gliner_model": "urchade/gliner_large-v2.1",
    "enable_llm_fallback": false,
    "gliner_labels": [
      "video_content",
      "visual_content",
      "document_content",
      "text_information",
      "time_reference",
      "date_pattern",
      "search_intent"
    ],
    "gliner_threshold": 0.3,
    "optimization_results": {
      "strategy": "focused",
      "accuracy": 0.9333,
      "optimized_on": "2025-01-03",
      "configurations_tested": 608,
      "best_runtime": "49.4s"
    }
  },
  "pipeline_config": {
    "extract_keyframes": true,
    "transcribe_audio": true,
    "generate_descriptions": true,
    "generate_embeddings": true,
    "keyframe_extraction_method": "fps",
    "keyframe_fps": 1.0
  },
  "device": "mps",
  "max_workers": 4,
  "timeout": 60.0,
  "log_level": "INFO",
  "log_file": "multi_agent_system.log",
  "output_base_dir": "outputs",
  "video_data_dir": "data/videos",
  "text_data_dir": "data/text",
  "index_dir": "data/indexes",
  "inference": {
    "provider": "modal",
    "local_endpoint": "http://localhost:11434",
    "model": "HuggingFaceTB/SmolLM3-3B",
    "modal_endpoint": "https://amit-jain--general-inference-service-serve.modal.run",
    "timeout": 30,
    "retry_count": 3,
    "retry_delay": 1.0,
    "prompts": {
      "artifacts_path": null,
      "default_system_prompt": "You are a precise and efficient routing agent. Analyze the query and output a JSON object with 'search_modality' (video or text) and 'generation_type' (detailed_report, summary, or raw_results)."
    },
    "model_config": {
      "temperature": 0.1,
      "max_tokens": 100,
      "model": "deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B"
    }
  },
  "optimization": {
    "enabled": true,
    "type": "dspy",
    "teacher": {
      "model": "claude-3-5-sonnet-20241022",
      "provider": "anthropic"
    },
    "student": {
      "model": "HuggingFaceTB/SmolLM3-3B",
      "provider": "modal"
    },
    "providers": {
      "modal": {
        "gpu_config": "A10G",
        "memory_mb": 16000,
        "timeout_seconds": 3600
      },
      "local": {
        "base_url": "http://localhost:11434",
        "timeout": 30
      },
      "anthropic": {
        "api_key_env": "ANTHROPIC_API_KEY"
      },
      "openai": {
        "api_key_env": "OPENAI_API_KEY"
      }
    },
    "settings": {
      "num_examples": 50,
      "num_candidates": 10,
      "num_trials": 20
    },
    "output": {
      "dir": "optimization_results"
    },
    "artifact_storage": {
      "type": "modal",
      "modal": {
        "volume_name": "optimization-artifacts",
        "remote_path": "/artifacts/unified_router_prompt_artifact.json"
      },
      "local": {
        "base_path": "./optimization_results"
      }
    }
  }
}